(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{620:function(s,t,n){"use strict";n.r(t);var a=n(11),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("本节文档介绍如何制作读取最新存档功能")])]),n("p",[s._v("参考教程：https://www.renpy.cn/thread-843-1-1.html")]),s._v(" "),n("h2",{attrs:{id:"需求描述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#需求描述"}},[s._v("#")]),s._v(" 需求描述")]),s._v(" "),n("p",[s._v("Ren'Py 引擎为我们提供了 "),n("code",[s._v("QuickLoad()")]),s._v(" 功能，但是这个功能只会读取最新的 QuickSave 存档，而不是最新存档，对位于主菜单的 Q.Load ，我们希望它能够搜索并读取所有存档中最新的那个")]),s._v(" "),n("h2",{attrs:{id:"修改代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改代码"}},[s._v("#")]),s._v(" 修改代码")]),s._v(" "),n("p",[s._v("Ren'Py 没有直接提供相关功能的参考代码，不过上面的教程里面有，我们把它稍稍修改一下即可使用")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参考 ver1.0 screen.rpy 563-588行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里省略掉了部分注释")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Q.Load 功能")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用 try 防止抛出错误（原因有二，一是第一次打开没有存档会找不到，二是这里使用的一个 Python2 库中有一个会抛出 Warning 的非恶性 Bug ，不影响运行，但是会抛出一个错误框给玩家，我们要屏蔽这个 Warning）")]),s._v("\n\n    $ latest_file "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" renpy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("newest_slot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("regexp"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    default l_f_page "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"auto"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# default，默认值，主要作用在于预定义变量")]),s._v("\n    default l_f_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# try 部分，同样省略了部分无关代码和无关注释")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参考 ver1.0 screen.rpy 2807-2823行")]),s._v("\ninit python"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自动存档功能，用 try 防止抛出错误，该错误属于 Warning ，不影响运行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个 Warning 是由于 Python2 自身的一个问题导致的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# except 的内容会在控制台（Release看不到）和 Linux 版（在终端能看到）输出")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        l_f_page "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" latest_file_str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#所在页 #auto-1表示自动存档页第一位")]),s._v("\n        l_f_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" latest_file_str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#槽位名")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Powered By Luckykeeper and LOVE69 Ren\'Py Remaster Project"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Luckykeeper\'s Blog: https://luckykeeper.site/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Offical Website: https://love69renpyremasterproject.github.io/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GitHub: https://github.com/luckykeeper/LOVE69_renpy_remaster"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gitee: https://gitee.com/luckykeeper/LOVE69_renpy_remaster"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GitLab: https://gitlab.com/luckykeeper/LOVE69_renpy_remaster"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"你 Star 了嘛？还没的话快去到 GitHub 或者 Gitee 或者 GitLab 给我们个 Star 呗！"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("h2",{attrs:{id:"调用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#调用"}},[s._v("#")]),s._v(" 调用")]),s._v(" "),n("p",[s._v("参考以下代码")]),s._v(" "),n("p",[s._v("重点关注 "),n("code",[s._v("action")]),s._v(" 一行")]),s._v(" "),n("p",[s._v("也就是 "),n("code",[s._v("action [FileLoad(name=l_f_name, confirm=True, page=l_f_page)]")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参考 ver1.0 screen.rpy 592-609行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Q.Load btn 的 vbox")]),s._v("\n    vbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定位")]),s._v("\n        xalign "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n        yalign "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.25")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" persistent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gameStarted"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 防止没有开始游戏就去点击导致的出错")]),s._v("\n            imagebutton"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Q.Load btn 放大到 1080p 对应的大小是 191x304 px ，稍稍大几个像素方便定位")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## idle 初始状态")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## hover 鼠标放在上面的状态")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## selected_hover 按下 btn 的状态")]),s._v("\n                idle "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gui/main_menu/btn_qload_base.png"')]),s._v("\n                hover "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gui/main_menu/btn_qload_onMouse.png"')]),s._v("\n                selected_hover "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gui/main_menu/btn_qload_onClick.png"')]),s._v("\n                hover_sound "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"voice/effect/マウス乗せ音.ogg"')]),s._v("\n                activate_sound "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"voice/effect/メニュー決定音.ogg"')]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FileLoad() 读取存档, name=l_f_name 要读取的存档是刚刚代码搜索到的最新存档")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# confirm=True 这个操作需要玩家确认，page 存档所在页")]),s._v("\n                action "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("FileLoad"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("l_f_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" confirm"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" page"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("l_f_page"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# action [FileLoad(name=renpy.newest_slot(regexp=None).split('-',1)[0], confirm=True, page=renpy.newest_slot(regexp=None).split('-',1)[1])]")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);